## Early Return

可以减少嵌套，提高代码可读性

```kotlin
// bad code
fun processOrder(order: Order?) {
    if (order != null) {
        if (order.items != null) {
            if (order.items.isNotEmpty()) {
                if (order.status == "pending") {
                    // 处理订单
                }
            }
        }
    }
}

// good code
fun processOrder(order: Order?) {
    if (order == null) return
    if (order.items.isNullOrEmpty()) return
    if (order.status != "pending") return
    // 处理订单
}
```

## Lazy Function

惰性函数是一种编程优化技术，通过延迟计算或避免重复计算来提高性能。它在不同领域的应用场景如下：

### 浏览器兼容性检查

Kotlin 没有浏览器环境，但可以用对象表达"惰性初始化"思想：

```kotlin
// 用于演示惰性函数思想
object EventAdder {
    private var adder: ((Any, String, () -> Unit) -> Unit)? = null

    fun addEvent(element: Any, type: String, handler: () -> Unit) {
        if (adder == null) {
            adder = if (/* 检查条件 */) {
                { el, t, h -> /* 新API方式 */ }
            } else {
                { el, t, h -> /* 旧API方式 */ }
            }
        }
        adder?.invoke(element, type, handler)
    }
}
```
### 文件系统操作
延迟打开文件或读取配置，直到实际需要时执行。

```kotlin
val config: Config by lazy {
    loadConfigFromFile()
}

fun getConfig(): Config = config
```

## no if or while without {}

绝对不允许出现不加 `{}` 的 `if` 或 `while` 语句。

```c
if((err = SSLHashSHA1.update(&hashCtx, &signedParams)) != 0)
  goto fail;
  goto fail;
```

## value condition to table search

将值条件转换为表查找，可以提高代码可读性和性能。

```kotlin
val valueAndLabel = mapOf(
    1 to "label1",
    2 to "label2",
    3 to "label3"
)
// good code for table search
fun getLabel(value: Int): String? {
    return valueAndLabel[value]
}
// bad code for if else if
fun getLabel(value: Int): String? {
    return if (value == 1) {
        "label1"
    } else if (value == 2) {
        "label2"
    } else if (value == 3) {
        "label3"
    } else null
}
// bad code for when
fun getLabel(value: Int): String? {
    return when (value) {
        1 -> "label1"
        2 -> "label2"
        3 -> "label3"
        else -> null
    }
}
```

## Be cautious with non-null assertions

在具有空安全特性的编程语言中（如 TypeScript、Kotlin、Swift 等），应该谨慎使用非空断言操作符。盲目使用可能导致运行时错误。

```kotlin
// bad code
fun processUser(user: User?) {
    // 危险!假设 user 一定不为空
    println(user!!.name)
}

// good code - use null check
fun processUser(user: User?) {
    if (user == null) return
    println(user.name)
}

// good code - use safe call
fun processUser(user: User?) {
    println(user?.name)
}
```
